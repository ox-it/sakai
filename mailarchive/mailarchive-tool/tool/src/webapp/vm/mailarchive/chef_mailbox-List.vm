##<!-- $Header: /cvs/sakai2/legacy/tools/src/webapp/vm/email/chef_mailbox-List.vm,v 1.9 2005/06/06 18:47:18 ggolden.umich.edu Exp $ -->
#if (${allow-search})
<script type="text/javascript" language="JavaScript">
  focus_path = ["search"];
</script>
#end
<div class="portletBody">
	#if($menu)#toolbar($menu)#end
	
	<div class="navPanel">
		<div class="page-header">
			<h1>$mailarchive_title</h1>
		</div>
		<div class="sak-banner-info">$tlang.getString("toolRetired")</div>
	</div>

	#if ($alertMessage)<div class="alertMessage">$tlang.getString("gen.alert") $formattedText.escapeHtml($alertMessage)</div><div class="clear"></div>#end
	#if ($sort-order)
		#set ($sort-img = "sakai/sortascending.gif")
		#set ($sort-dir = "ascending")
	#else
		#set ($sort-img = "sakai/sortdescending.gif")
		#set ($sort-dir = "descending")
	#end

	<div class="sakai-table-toolBar">
		#if (${allow-search})
		<div class="sakai-table-filterContainer">
			<form name="toolbar" action="#toolForm("$action")" method="post">
				<div class="sakai-table-searchFilter">
					<label for="search">$tlang.getString('lis.search')</label>
					<div class="sakai-table-searchFilterControls">
						<input size="15" value="$formattedText.escapeHtml($!search)" name="search" id="search" type="text" class="sakai-table-searchFilter-searchField" />
						<a href="#" title="$tlang.getString('lis.search')" onclick="location = '#toolLink("$action" "doSearch")'+buildQueryString('toolbar');document.getElementById('submitnotifwrap').style.display='block';return false;">
							<input type="button" value="$tlang.getString('lis.search')" />
						</a>
						#if (($!search) && (!$search.equals("")))
							<a href="#" title="$tlang.getString('lis.clear')" onclick="location = '#toolLink("$action" "doSearch_clear")';return false;">
								<input type="button" value="$tlang.getString('lis.clear')" style="margin-left:4px;" />
							</a>
						#end
						<div id="submitnotifwrap" style="padding:7px;display:none;"><span id="submitnotif">$tlang.getString("lis.searchnotif")</span></div>
					</div>
					<input type="hidden" name="eventSubmit_doSearch" id="eventSubmit_doSearch" value="$tlang.getString('lis.search')" />
					<input type="hidden" name="sakai_csrf_token" value="$sakai_csrf_token" />
				</div>
			</form>
		</div>
		#end
		#if($!allMsgNumberInt && $allMsgNumberInt > 0)
			<div class="sakai-table-pagerContainer">
				#pagerPanel("pager1")
			</div>
		#end
	</div>

	#if($!allMsgNumberInt && $allMsgNumberInt > 0)
		<table class ="listHier lines nolines specialLink" cellspacing="0" summary ="$tlang.getString("lis.summary")">
			<tr>
				<th id="from">
					<a href="#" onclick = "location = '#toolLink($action "doSort_from")';return false;"  title ="$tlang.getString("lis.sortbysen")">
						$tlang.getString("gen.fro")
						#if ($sort-by == 0)<img border="0" src="#imageLink($sort-img)" alt="$tlang.getString("lis.sortbysen") $sort-dir" />#end
					</a>
				</th>
				<th id="subject">
					<a href="#" onclick = "location = '#toolLink($action "doSort_subject")';return false;"   title = "$tlang.getString("lis.sortbysub")">
						$tlang.getString("gen.sub")
						#if ($sort-by == 2)<img border="0" src="#imageLink($sort-img)" alt="$tlang.getString("lis.sortbysub") $sort-dir" />#end
					</a>
				</th>
				<th id="date">
					<a href="#" onclick = "location = '#toolLink($action "doSort_date")';return false;"   title ="$tlang.getString("lis.sortbydat")">
						$tlang.getString("gen.datre")
						#if ($sort-by == 1)<img border="0" src="#imageLink($sort-img)" alt ="$tlang.getString("lis.sortbydat") $sort-dir" />#end
					</a>
				</th>
			</tr>
			#set($msgPos=$topMsgPosInt)
			#foreach ($item in $messages)
           #if ("$item.Header.Subject" == "")
               #set ($item.Header.Subject = $tlang.getString("err_no_subject"))
           #end
				<tr>
					<td headers="from">$formattedText.escapeHtml($item.Header.FromAddress)</td>
					<td headers="subject">
						<h4><a href="#"
						onclick="location = '#toolLinkParam($action "doView" "$view-id=$formattedText.escapeUrl($item.Header.Id)&amp;item_number=$msgPos")';return false;"
						title="$tlang.getString("lis.viewmessage") $formattedText.escapeHtml($item.Header.Subject)">
							$formattedText.escapeHtml($item.Header.Subject)

							## show the paperclip if existing
							#set ($size = 0)
							#if (!$item.Header.Attachments.isEmpty())
								#set ($props = false)
								#set ($size = $item.Header.Attachments.size())
								#foreach ($attachment in $item.Header.Attachments)
									#set ($props = $attachment.Properties)
									#if (!$props)
											#if ($size > 0) #set ($size = $size - 1) #end
									#end
								#end
							#end
							#if ($size == 0)
							#else
								<img src = "#imageLink("sakai/attachments.gif")" border="0" alt="$tlang.getString("lis.att")" />
							#end
						</a></h4>
					</td>
					<td headers="date">$item.Header.DateSent.toStringLocalFullZ()</td>
				</tr>
				#set($msgPos=$msgPos+1)
			#end
		</table>
	#else
		<p class="instruction">
			#if (($!search) && (!$search.equals("")))
				$tlang.getString("lis.nosearchresults")
			#else
				$tlang.getString("lis.noema")
			#end
		</p>
	#end
</div>	
